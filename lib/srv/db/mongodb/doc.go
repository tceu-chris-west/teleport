/*
Copyright 2020 Gravitational, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

// stuff happens
// https://docs.mongodb.com/manual/reference/mongodb-wire-protocol/

package mongodb
/*
import (
	"context"
	"time"

	"go.mongodb.org/mongo-driver/mongo/description"
	"go.mongodb.org/mongo-driver/x/mongo/driver/topology"
	"go.mongodb.org/mongo-driver/x/mongo/driver/connstring"
)

cs, err := connstring.ParseAndValidate("mongodb://localhost:27017/")
cs.SSL = true
cs.SSLSet = true
cs.SSLInsecure = true
cs.SSLInsecureSet = true
cs.SSLClientCertificateKeyFile = "me.cert.and.key.pem"
cs.SSLClientCertificateKeyFileSet = true

t, err := topology.New(
	topology.WithConnString(
		func (connstring.ConnString) connstring.ConnString { return cs }
	)
)

err := t.Connect()
ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)
srv, err := t.SelectServer(ctx, description.WriteSelector())
conn, err := srv.Connection(ctx)
conn.WriteWireMessage(ctx, []byte{4,0,0,0})
conn.Close()
t.Disconnect(ctx)
*/

/*

client --> proxy --> db

client                     proxy                    db
  |                          |                       |
  | --- TLS ClientHello -->  |                       |
  |                          | <-- TLS Handshake --> |
  |                          | --- IsMaster() -->    |
  |                          |       <-- Response -- |
  | <-- TLS Completion -->   |                       |
  | --- IsMaster() -->       |                       |
  |    <-- SOMETHING?!?! --- |                       |
  | -----------------------> | --------------------> |
  | <----------------------- | <-------------------- |


FROM CLIENT

length 313b          0x39, 0x1, 0x0, 0x0
request id 0         0x0, 0x0, 0x0, 0x0
response to 0        0x0, 0x0, 0x0, 0x0
OP_QUERY             0xd4, 0x7, 0x0, 0x0
flags 0x0000         0x0, 0x0, 0x0, 0x0
admin.$cmd           0x61, 0x64, 0x6d, 0x69, 0x6e, 0x2e, 0x24, 0x63, 0x6d, 0x64, 0x0
num to skip 0        0x0, 0x0, 0x0, 0x0
num to return 1      0x1, 0x0, 0x0, 0x0
query bson
  len 289b           0x12, 0x1, 0x0, 0x0
  k isMaster         0x10, 0x69, 0x73, 0x4d, 0x61, 0x73, 0x74, 0x65, 0x72, 0x0
  v 1                0x1, 0x0, 0x0, 0x0
  k hostInfo         0x2, 0x68, 0x6f, 0x73, 0x74, 0x49, 0x6e, 0x66, 0x6f, 0x0,
  v str              0x1e, 0x0, 0x0, 0x0, 0x54, 0x43, 0x45, 0x55, 0x73, 0x2d, 0x4d, 0x61, 0x63, 0x42, 0x6f, 0x6f, 0x6b, 0x2d, 0x50, 0x72, 0x6f, 0x2e, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x3a, 0x32, 0x37, 0x30, 0x31, 0x37, 0x0
    TCEUs-MacBook-Pro.local:27017
  k client           0x3, 0x63, 0x6c, 0x69, 0x65, 0x6e, 0x74, 0x0
  v (embedded doc)
    len 203b         0xcb, 0x0, 0x0, 0x0
    k application    0x3, 0x61, 0x70, 0x70, 0x6c, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x0
    v (embedded doc)
      len 29b        0x1d, 0x0, 0x0, 0x0
      k name         0x2, 0x6e, 0x61, 0x6d, 0x65, 0x0
      v str          0xe, 0x0, 0x0, 0x0, 0x4d, 0x6f, 0x6e, 0x67, 0x6f, 0x44, 0x42, 0x20, 0x53, 0x68, 0x65, 0x6c, 0x6c, 0x0
        MongoDB Shell
    0x0
    k driver         0x3, 0x64, 0x72, 0x69, 0x76, 0x65, 0x72, 0x0
    v (embedded doc)
      len 58b        0x3a, 0x0, 0x0, 0x0
      k name         0x2, 0x6e, 0x61, 0x6d, 0x65, 0x0
      v str          0x18, 0x0, 0x0, 0x0 0x4d, 0x6f, 0x6e, 0x67, 0x6f, 0x44, 0x42, 0x20, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x61, 0x6c, 0x20, 0x43, 0x6c, 0x69, 0x65, 0x6e, 0x74, 0x0
        MongoDB Internal Client
      k version      0x2, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0
      v              0x6, 0x0, 0x0, 0x0 0x34, 0x2e, 0x32, 0x2e, 0x30, 0x0
    0x0
    k os             0x3, 0x6f, 0x73, 0x0
    v (embedded doc)
      len 86b        0x56, 0x0, 0x0, 0x0
      k type         0x2, 0x74, 0x79, 0x70, 0x65, 0x0
      v Darwin       0x7, 0x0, 0x0, 0x0, 0x44, 0x61, 0x72, 0x77, 0x69, 0x6e, 0x0
      k name         0x2, 0x6e, 0x61, 0x6d, 0x65, 0x0
      v Mac OS X     0x9, 0x0, 0x0, 0x0, 0x4d, 0x61, 0x63, 0x20, 0x4f, 0x53, 0x20, 0x58, 0x0
      k architecture 0x2, 0x61, 0x72, 0x63, 0x68, 0x69, 0x74, 0x65, 0x63, 0x74, 0x75, 0x72, 0x65, 0x0
      v x86_64       0x7, 0x0, 0x0, 0x0, 0x78, 0x38, 0x36, 0x5f, 0x36, 0x34, 0x0
      k version      0x2, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0
      v 19.6.0       0x7, 0x0, 0x0, 0x0, 0x31, 0x39, 0x2e, 0x36, 0x2e, 0x30, 0x0
    0x0
  0x0
0x0_

SERVER RESPONSE TO HACKED CLIENT ISMASTER:

len     0x3f, 0x1, 0x0, 0x0
req id  0xa9, 0x0, 0x0, 0x0
resp to 0x0, 0x0, 0x0, 0x0
op_code 0x1, 0x0, 0x0, 0x0

flags   0x8, 0x0, 0x0, 0x0 //AwaitCapable
cursor  0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
start   0x0, 0x0, 0x0, 0x0
number  0x1, 0x0, 0x0, 0x0
documents 
  len 0x1b, 0x1, 0x0, 0x0
  k 0x8, 0x69, 0x73, 0x6d, 0x61, 0x73, 0x74, 0x65, 0x72, 0x0 //ismaster
  v 0x1 // true
  k 0x3, 0x74, 0x6f, 0x70, 0x6f, 0x6c, 0x6f, 0x67, 0x79, 0x56, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0 // topologyVersion
  v 0x2d, 0x0, 0x0, 0x0
    k 0x7, 0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x49, 0x64, 0x0 // processId
    v 0x60, 0x61, 0xc8, 0xf7, 0x91, 0x76, 0xe0, 0xdc, 0x3f, 0x19, 0x88, 0x73
    k 0x12, 0x63, 0x6f, 0x75, 0x6e, 0x74, 0x65, 0x72, 0x0 // counter
    v 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
  0x0
  k 0x10, 0x6d, 0x61, 0x78, 0x42, 0x73, 0x6f, 0x6e, 0x4f, 0x62, 0x6a, 0x65, 0x63, 0x74, 0x53, 0x69, 0x7a, 0x65, 0x0 // maxBsonObjectSize
  v 0x0, 0x0, 0x0, 0x1
  k 0x10, 0x6d, 0x61, 0x78, 0x4d, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x53, 0x69, 0x7a, 0x65, 0x42, 0x79, 0x74, 0x65, 0x73, 0x0 // maxMessageSizeBytes
  v 0x0, 0x6c, 0xdc, 0x2
  k 0x10, 0x6d, 0x61, 0x78, 0x57, 0x72, 0x69, 0x74, 0x65, 0x42, 0x61, 0x74, 0x63, 0x68, 0x53, 0x69, 0x7a, 0x65, 0x0 //
  v 0xa0, 0x86, 0x1, 0x0
  k 0x9, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x54, 0x69, 0x6d, 0x65, 0x0
  v 0x9, 0x83, 0xd3, 0x7e, 0x78, 0x1, 0x0, 0x0
  k 0x10, 0x6c, 0x6f, 0x67, 0x69, 0x63, 0x61, 0x6c, 0x53, 0x65, 0x73, 0x73, 0x69, 0x6f, 0x6e, 0x54, 0x69, 0x6d, 0x65, 0x6f, 0x75, 0x74, 0x4d, 0x69, 0x6e, 0x75, 0x74, 0x65, 0x73, 0x0
  v 0x1e, 0x0, 0x0, 0x0
  k 0x10, 0x63, 0x6f, 0x6e, 0x6e, 0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e, 0x49, 0x64, 0x0
  v 0xf, 0x0, 0x0, 0x0
  k 0x10, 0x6d, 0x69, 0x6e, 0x57, 0x69, 0x72, 0x65, 0x56, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0
  v 0x0, 0x0, 0x0, 0x0
  k 0x10, 0x6d, 0x61, 0x78, 0x57, 0x69, 0x72, 0x65, 0x56, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0
  v 0x9, 0x0, 0x0, 0x0
  k 0x8, 0x72, 0x65, 0x61, 0x64, 0x4f, 0x6e, 0x6c, 0x79, 0x0
  v 0x0, // false
  k 0x1, 0x6f, 0x6b, 0x0
  v 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xf0, 0x3f
0x0

CLIENT FOLLOW-UP
len       0x39, 0x0, 0x0, 0x0
req id    0x1, 0x0, 0x0, 0x0
res to    0x0, 0x0, 0x0, 0x0
op_code   0xdd, 0x7 // OP_MSG
flagbits  0x0, 0x0, 0x0, 0x0
section 1
  size    0x0, 0x0, 0x0, 0x24
  seq id  0x0, 0x0, 0x0
  k 0x10, 0x77, 0x68, 0x61, 0x74, 0x73, 0x6d, 0x79, 0x75, 0x72, 0x69, 0x0, // whatsmyuri
  v 0x1, 0x0, 0x0, 0x0 // 1
  k 0x2, 0x24, 0x64, 0x62, 0x0 // $db
  v 0x6, 0x0, 0x0, 0x0, 0x61, 0x64, 0x6d, 0x69, 0x6e, 0x0 // admin
0x0

SERVER REPLY [bogus]
len       0x3f, 0x1, 0x0, 0x0,
req id    0xaa, 0x0, 0x0, 0x0
res to    0x0, 0x0, 0x0, 0x0
op_code   0x1, 0x0, 0x0, 0x0
flags     0x8, 0x0, 0x0, 0x0
cursor    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
start     0x0, 0x0, 0x0, 0x0
number    0x1, 0x0, 0x0, 0x0
len 0x1b, 0x1, 0x0, 0x0
  k 0x8, 0x69, 0x73, 0x6d, 0x61, 0x73, 0x74, 0x65, 0x72, 0x0//ismaster
  v 0x1, // true
  k 0x3, 0x74, 0x6f, 0x70, 0x6f, 0x6c, 0x6f, 0x67, 0x79, 0x56, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0
  v obj 0x2d, 0x0, 0x0, 0x0
    k 0x7, 0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x49, 0x64, 0x0
    v 0x60, 0x61, 0xc8, 0xf7, 0x91, 0x76, 0xe0, 0xdc, 0x3f, 0x19, 0x88, 0x73,
    k 0x12, 0x63, 0x6f, 0x75, 0x6e, 0x74, 0x65, 0x72, 0x0
    v 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
    k 0x10, 0x6d, 0x61, 0x78, 0x42, 0x73, 0x6f, 0x6e, 0x4f, 0x62, 0x6a, 0x65, 0x63, 0x74, 0x53, 0x69, 0x7a, 0x65, 0x0, 0x0, 0x0, 0x0, 0x1, 0x10, 0x6d, 0x61, 0x78, 0x4d, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x53, 0x69, 0x7a, 0x65, 0x42, 0x79, 0x74, 0x65, 0x73, 0x0, 0x0, 0x6c, 0xdc, 0x2, 0x10, 0x6d, 0x61, 0x78, 0x57, 0x72, 0x69, 0x74, 0x65, 0x42, 0x61, 0x74, 0x63, 0x68, 0x53, 0x69, 0x7a, 0x65, 0x0, 0xa0, 0x86, 0x1, 0x0, 0x9, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x54, 0x69, 0x6d, 0x65, 0x0, 0xf, 0x83, 0xd3, 0x7e, 0x78, 0x1, 0x0, 0x0, 0x10, 0x6c, 0x6f, 0x67, 0x69, 0x63, 0x61, 0x6c, 0x53, 0x65, 0x73, 0x73, 0x69, 0x6f, 0x6e, 0x54, 0x69, 0x6d, 0x65, 0x6f, 0x75, 0x74, 0x4d, 0x69, 0x6e, 0x75, 0x74, 0x65, 0x73, 0x0, 0x1e, 0x0, 0x0, 0x0, 0x10, 0x63, 0x6f, 0x6e, 0x6e, 0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e, 0x49, 0x64, 0x0, 0xf, 0x0, 0x0, 0x0, 0x10, 0x6d, 0x69, 0x6e, 0x57, 0x69, 0x72, 0x65, 0x56, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10, 0x6d, 0x61, 0x78, 0x57, 0x69, 0x72, 0x65, 0x56, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x0, 0x9, 0x0, 0x0, 0x0, 0x8, 0x72, 0x65, 0x61, 0x64, 0x4f, 0x6e, 0x6c, 0x79, 0x0, 0x0, 0x1, 0x6f, 0x6b, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xf0, 0x3f, 0x0


WHAT IS THIS CLIENT MSG??
len   0x5d, 0x1, 0x0, 0x0, 
reqid 0x1, 0x0, 0x0, 0x0, 
resto 0x0, 0x0, 0x0, 0x0, 
opcode 0xdd, 0x7,  // op_msg
flags 0x0, 0x0, 0x0, 0x0, 
sections 0x0, 0x0, 0x0, 
section 0 0x48, 0x1, 0x0, 0x0, 
  k 0x10, 0x61, 0x75, 0x74, 0x68, 0x65, 0x6e, 0x74, 0x69, 0x63, 0x61, 0x74, 0x65, 0x0,
    authenticate
  v 0x1, 0x0, 0x0, 0x0,
    1
  k 0x2, 0x6d, 0x65, 0x63, 0x68, 0x61, 0x6e, 0x69, 0x73, 0x6d, 0x0,
    mechanism
  v 0xd, 0x0, 0x0, 0x0, 0x4d, 0x4f, 0x4e, 0x47, 0x4f, 0x44, 0x42, 0x2d, 0x58, 0x35, 0x30, 0x39, 0x0, 
    MONGODB-X509
  k 0x2, 0x75, 0x73, 0x65, 0x72, 0x0, 
    user
  v 0xf8, 0x0, 0x0, 0x0, 0x31, 0x2e, 0x33, 0x2e, 0x39, 0x39, 0x39, 0x39, 0x2e, 0x32, 0x2e, 0x36, 0x3d, 0x2a, 0x2c, 0x31, 0x2e, 0x33, 0x2e, 0x39, 0x39, 0x39, 0x39, 0x2e, 0x32, 0x2e, 0x35, 0x3d, 0x2a, 0x2c, 0x31, 0x2e, 0x33, 0x2e, 0x39, 0x39, 0x39, 0x39, 0x2e, 0x32, 0x2e, 0x32, 0x3d, 0x6d, 0x6f, 0x6e, 0x67, 0x6f, 0x64, 0x62, 0x2c, 0x31, 0x2e, 0x33, 0x2e, 0x39, 0x39, 0x39, 0x39, 0x2e, 0x32, 0x2e, 0x31, 0x3d, 0x74, 0x65, 0x73, 0x74, 0x2c, 0x31, 0x2e, 0x33, 0x2e, 0x39, 0x39, 0x39, 0x39, 0x2e, 0x31, 0x2e, 0x37, 0x3d, 0x54, 0x43, 0x45, 0x55, 0x73, 0x2d, 0x4d, 0x61, 0x63, 0x42, 0x6f, 0x6f, 0x6b, 0x2d, 0x50, 0x72, 0x6f, 0x2e, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x2c, 0x43, 0x4e, 0x3d, 0x74, 0x65, 0x73, 0x74, 0x75, 0x73, 0x65, 0x72, 0x2c, 0x4f, 0x3d, 0x61, 0x64, 0x6d, 0x69, 0x6e, 0x2b, 0x4f, 0x3d, 0x64, 0x62, 0x2c, 0x70, 0x6f, 0x73, 0x74, 0x61, 0x6c, 0x43, 0x6f, 0x64, 0x65, 0x3d, 0x7b, 0x5c, 0x22, 0x6c, 0x6f, 0x67, 0x69, 0x6e, 0x73, 0x5c, 0x22, 0x3a, 0x6e, 0x75, 0x6c, 0x6c, 0x7d, 0x2c, 0x73, 0x74, 0x72, 0x65, 0x65, 0x74, 0x3d, 0x54, 0x43, 0x45, 0x55, 0x73, 0x2d, 0x4d, 0x61, 0x63, 0x42, 0x6f, 0x6f, 0x6b, 0x2d, 0x50, 0x72, 0x6f, 0x2e, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x2c, 0x4c, 0x3d, 0x2d, 0x74, 0x65, 0x6c, 0x65, 0x70, 0x6f, 0x72, 0x74, 0x2d, 0x6e, 0x6f, 0x6c, 0x6f, 0x67, 0x69, 0x6e, 0x2d, 0x61, 0x30, 0x35, 0x39, 0x32, 0x30, 0x32, 0x31, 0x2d, 0x63, 0x38, 0x36, 0x39, 0x2d, 0x34, 0x31, 0x64, 0x35, 0x2d, 0x62, 0x33, 0x30, 0x61, 0x2d, 0x61, 0x39, 0x32, 0x37, 0x38, 0x62, 0x30, 0x34, 0x64, 0x63, 0x62, 0x62, 0x0,
   1.3.9999.2.6=*,1.3.9999.2.5=*,1.3.9999.2.2=mongodb,1.3.9999.2.1=test,1.3.9999.1.7=TCEUs-MacBook-Pro.local,CN=testuser,O=admin+O=db,postalCode={\\"logins\\":null},street=TCEUs-MacBook-Pro.local,L=-teleport-nologin-a0592021-c869-41d5-b30a-a9278b04dcbb
  k 0x2, 0x24, 0x64, 0x62, 0x0,
    $db
  v 0xa, 0x0, 0x0, 0x0, 0x24, 0x65, 0x78, 0x74, 0x65, 0x72, 0x6e, 0x61, 0x6c, 0x0,
    $external
0x0

whyyy noooooooo



CLIENT show collections
len 0x95, 0x0, 0x0, 0x0, 
id 0xf, 0x0, 0x0, 0x0, 
rto 0x0, 0x0, 0x0, 0x0, 
opcode 0xdd, 0x7,
flags 0x0, 0x0, 0x0, 0x0, 
section 0x0, 0x0, 0x0,
len 0x80, 0x0, 0x0, 0x0,
 k 0x1, 0x6c, 0x69, 0x73, 0x74, 0x43, 0x6f, 0x6c, 0x6c, 0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e, 0x73, 0x0, 
   listCollections
 v 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xf0, 0x3f,
 k 0x3, 0x66, 0x69, 0x6c, 0x74, 0x65, 0x72, 0x0,
   filter
 v 0x5, 0x0, 0x0, 0x0,
 0x0,
 k 0x8, 0x6e, 0x61, 0x6d, 0x65, 0x4f, 0x6e, 0x6c, 0x79, 0x0, 
   nameOnly
 v 0x1,
   true
 k 0x8, 0x61, 0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x7a, 0x65, 0x64, 0x43, 0x6f, 0x6c, 0x6c, 0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e, 0x73, 0x0, 
   authorizedCollections
 v 0x1,
   true 
 k 0x3, 0x6c, 0x73, 0x69, 0x64, 0x0,
   lsid
 v 0x1e, 0x0, 0x0, 0x0,
   k 0x5, 0x69, 0x64, 0x0, 
   id
   v 0x10, 0x0, 0x0, 0x0, 0x4, 0xaa, 0x80, 0x4e, 0x2a, 0xcc, 0xf, 0x4c, 0x9d, 0xbd, 0x29, 0xe, 0x5, 0x1d, 0xce, 0xbc, 0x29,
     (binary stuff)
   0x0,
 k 0x2, 0x24, 0x64, 0x62, 0x0,
   $db
 v 0x5, 0x0, 0x0, 0x0, 0x74, 0x65, 0x73, 0x74, 0x0,
   test
0x0

len 0x99, 0x0, 0x0, 0x0,
id 0x18, 0x0, 0x0, 0x0,
rto 0x0, 0x0, 0x0, 0x0,
opco 0xdd, 0x7,
flags 0x0, 0x0, 0x0, 0x0,
section 0x0, 0x0, 0x1,
 len 0x32, 0x0, 0x0, 0x0,
 id 0x64, 0x6f, 0x63, 0x75, 0x6d, 0x65, 0x6e, 0x74, 0x73, 0x0,
    documents
    len 0x24, 0x0, 0x0, 0x0, 
    k 0x7, 0x5f, 0x69, 0x64, 0x0,
      _id
    v  0x60, 0x64, 0xa3, 0x6b, 0x2a, 0xc9, 0xe7, 0xe6, 0xa0, 0x8f, 0xa1, 0x72,
    k  0x2, 0x63, 0x77, 0x0,
       cw
    v  0x6, 0x0, 0x0, 0x0, 0x69, 0x6e, 0x6e, 0x69, 0x74, 0x0,
       innit
  0x0,
0x0,
  len 0x51, 0x0, 0x0, 0x0,
       0x2, 0x69, 0x6e, 0x73, 0x65, 0x72, 0x74, 0x0,
       0x4, 0x0, 0x0, 0x0, 0x66, 0x6f, 0x6f, 0x0,
       0x8, 0x6f, 0x72, 0x64, 0x65, 0x72, 0x65, 0x64, 0x0,
       0x1, 0x3, 0x6c, 0x73, 0x69, 0x64, 0x0,
       lsid
       0x1e, 0x0, 0x0, 0x0,
         0x5, 0x69, 0x64, 0x0,
         id
         0x10, 0x0, 0x0, 0x0, 0x4, 0xbd, 0x95, 0x30, 0x16, 0xab, 0x58, 0x4c, 0xd, 0x97, 0x43, 0x18, 0xf9, 0xb2, 0x6d, 0x72, 0xa9,
       0x0,
       0x2, 0x24, 0x64, 0x62, 0x0,
       $db
       0x5, 0x0, 0x0, 0x0, 0x74, 0x65, 0x73, 0x74, 0x0,
       test
     0x0
*/
